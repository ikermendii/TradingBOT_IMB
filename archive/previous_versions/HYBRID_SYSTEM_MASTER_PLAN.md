# üöÄ MASTER PLAN: Sistema H√≠brido Universal (v11.0-UNIVERSAL)

**Fecha:** 2025-12-28
**Objetivo:** Bot que funcione √ìPTIMAMENTE en CUALQUIER r√©gimen de mercado
**Timeline:** 3-4 semanas
**Versi√≥n final:** v11.0-UNIVERSAL

---

## üéØ Visi√≥n del Sistema

### Concepto Central: DUAL-STRATEGY con REGIME DETECTION

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ                   v11.0-UNIVERSAL SYSTEM                     ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ                                                              ‚îÇ
‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê         ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê         ‚îÇ
‚îÇ  ‚îÇ REGIME DETECTOR  ‚îÇ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ñ∂‚îÇ  STRATEGY SWITCH ‚îÇ         ‚îÇ
‚îÇ  ‚îÇ                  ‚îÇ         ‚îÇ                  ‚îÇ         ‚îÇ
‚îÇ  ‚îÇ ‚Ä¢ ADX 4H         ‚îÇ         ‚îÇ  IF parabolic:   ‚îÇ         ‚îÇ
‚îÇ  ‚îÇ ‚Ä¢ Price Momentum ‚îÇ         ‚îÇ    ‚Üí Trend Bot   ‚îÇ         ‚îÇ
‚îÇ  ‚îÇ ‚Ä¢ RSI 1D         ‚îÇ         ‚îÇ                  ‚îÇ         ‚îÇ
‚îÇ  ‚îÇ ‚Ä¢ Volatility ATR ‚îÇ         ‚îÇ  ELSE:           ‚îÇ         ‚îÇ
‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò         ‚îÇ    ‚Üí Mean Bot    ‚îÇ         ‚îÇ
‚îÇ                                ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò         ‚îÇ
‚îÇ                                                              ‚îÇ
‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê   ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê  ‚îÇ
‚îÇ  ‚îÇ  STRATEGY A:           ‚îÇ   ‚îÇ  STRATEGY B:           ‚îÇ  ‚îÇ
‚îÇ  ‚îÇ  MEAN-REVERSION        ‚îÇ   ‚îÇ  TREND-FOLLOWING       ‚îÇ  ‚îÇ
‚îÇ  ‚îÇ  (v9.3 actual)         ‚îÇ   ‚îÇ  (nuevo)               ‚îÇ  ‚îÇ
‚îÇ  ‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§   ‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§  ‚îÇ
‚îÇ  ‚îÇ ‚Ä¢ RSI oversold/bought  ‚îÇ   ‚îÇ ‚Ä¢ Breakout entries     ‚îÇ  ‚îÇ
‚îÇ  ‚îÇ ‚Ä¢ Divergencias         ‚îÇ   ‚îÇ ‚Ä¢ Trailing stop        ‚îÇ  ‚îÇ
‚îÇ  ‚îÇ ‚Ä¢ Fair Value Gaps      ‚îÇ   ‚îÇ ‚Ä¢ Momentum confirm     ‚îÇ  ‚îÇ
‚îÇ  ‚îÇ ‚Ä¢ TP: 3.0R             ‚îÇ   ‚îÇ ‚Ä¢ TP: 6-8R             ‚îÇ  ‚îÇ
‚îÇ  ‚îÇ ‚Ä¢ BE: 1.35R            ‚îÇ   ‚îÇ ‚Ä¢ BE: 3.0R             ‚îÇ  ‚îÇ
‚îÇ  ‚îÇ                         ‚îÇ   ‚îÇ                         ‚îÇ  ‚îÇ
‚îÇ  ‚îÇ √ìptimo: Volatilidad    ‚îÇ   ‚îÇ √ìptimo: Parab√≥lico     ‚îÇ  ‚îÇ
‚îÇ  ‚îÇ Result: +110% (2023)   ‚îÇ   ‚îÇ Result: +60%? (2020)   ‚îÇ  ‚îÇ
‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò   ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò  ‚îÇ
‚îÇ                                                              ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò

PERFORMANCE ESPERADA:
- Bull Parab√≥lico (2020-2021): +50-80% (Trend Bot)
- Alta Volatilidad (2022-2025): +80-110% (Mean Bot)
- Periodo completo (2020-2025): +70-100% ‚úÖ
- Calmar Ratio: >1.2 (ELITE universal)
```

---

## üìã FASE A: Mantener v9.3 Paper Trading (ACTUAL)

### Status Quo - YA EN MARCHA

**Bot activo:**
- Versi√≥n: v9.3-RSI36
- Exchange: Binance Futures Testnet
- Paper trading: S√ç
- Performance esperada: +110% anual en mercado actual

**Monitoreo continuo:**
1. Revisar trades diarios
2. Verificar que funciona como esperado
3. Acumular data de paper trading (m√≠nimo 50 trades)
4. Detectar cualquier anomal√≠a

**Sin cambios hasta que v11.0-UNIVERSAL est√© listo.**

---

## üìã FASE B: Desarrollo v11.0-UNIVERSAL (3-4 semanas)

### Roadmap Completo

```
SEMANA 1: Regime Detection + Trend Strategy Design
‚îú‚îÄ D√≠a 1-2: Dise√±ar algoritmo de detecci√≥n de r√©gimen
‚îú‚îÄ D√≠a 3-4: Implementar Trend-Following strategy
‚îî‚îÄ D√≠a 5-7: Backtest Trend strategy en 2020-2021

SEMANA 2: Integraci√≥n + Backtesting
‚îú‚îÄ D√≠a 8-10: Integrar ambas strategies en Jesse
‚îú‚îÄ D√≠a 11-12: Backtest sistema completo 2020-2025
‚îî‚îÄ D√≠a 13-14: Walk-forward validation

SEMANA 3: Optimizaci√≥n + Refinamiento
‚îú‚îÄ D√≠a 15-17: Ajustar par√°metros bas√°ndose en resultados
‚îú‚îÄ D√≠a 18-19: Stress testing (eventos extremos)
‚îî‚îÄ D√≠a 20-21: Finalizar c√≥digo Jesse

SEMANA 4: Migraci√≥n a Freqtrade + Deployment
‚îú‚îÄ D√≠a 22-24: Portar c√≥digo a Freqtrade
‚îú‚îÄ D√≠a 25-26: Testing en Testnet
‚îî‚îÄ D√≠a 27-28: Deployment en paper trading
```

---

## üîß COMPONENTE 1: Regime Detection

### Objetivo
Detectar autom√°ticamente si el mercado est√° en:
1. **BULL PARABOLIC** ‚Üí Usar Trend-Following
2. **HIGH VOLATILITY** ‚Üí Usar Mean-Reversion
3. **RANGING** ‚Üí No tradear

### Algoritmo de Detecci√≥n

```python
def detect_market_regime():
    """
    Detecta r√©gimen de mercado usando m√∫ltiples indicadores

    Returns:
        'parabolic' | 'volatile' | 'ranging'
    """
    # Calcular indicadores
    adx_4h = ta.adx(candles_4h, period=14)
    rsi_1d = ta.rsi(candles_1d, period=14)
    atr_pct = ta.atr(candles_15m, 14) / close * 100

    # Precio vs EMAs
    ema_50_4h = ta.ema(candles_4h, 50)
    ema_200_4h = ta.ema(candles_4h, 200)
    ema_diff_pct = ((ema_50_4h - ema_200_4h) / ema_200_4h) * 100

    # Momentum 30 d√≠as
    price_30d_ago = candles_1d[-30]['close']
    momentum_30d = ((close - price_30d_ago) / price_30d_ago) * 100

    # R√âGIMEN 1: BULL PARABOLIC
    if (
        adx_4h > 30 and              # Tendencia fuerte
        ema_diff_pct > 3.0 and       # EMA50 >> EMA200 (>3%)
        rsi_1d > 60 and              # RSI alto sostenido
        momentum_30d > 15            # +15% en 30 d√≠as
    ):
        return 'parabolic'

    # R√âGIMEN 2: HIGH VOLATILITY
    elif (
        atr_pct > 0.008 and          # ATR >0.8% (vol√°til)
        adx_4h > 15 and              # Algo de tendencia
        abs(momentum_30d) < 15       # Movimiento moderado
    ):
        return 'volatile'

    # R√âGIMEN 3: RANGING
    else:
        return 'ranging'
```

### Par√°metros de Detecci√≥n

| Indicador | Parabolic | Volatile | Ranging |
|-----------|-----------|----------|---------|
| **ADX 4H** | >30 | 15-30 | <15 |
| **EMA Diff %** | >3% | 0-3% | <1% |
| **RSI 1D** | >60 | 40-60 | 30-70 |
| **Momentum 30d** | >+15% | ¬±15% | <¬±5% |
| **ATR %** | <0.8% | >0.8% | <0.4% |

### Testing del Detector

**Backtest con datos hist√≥ricos:**
```
2020 Q1-Q2: Deber√≠a detectar 'parabolic' ‚Üí BTC $7k ‚Üí $29k
2022 Q1-Q2: Deber√≠a detectar 'volatile' ‚Üí BTC -50% crash
2023 Q4: Deber√≠a detectar 'parabolic' ‚Üí BTC $27k ‚Üí $44k
2024: Deber√≠a detectar 'volatile' ‚Üí BTC oscillating
```

**Validaci√≥n:**
- ‚úÖ Si detecta correctamente >80% del tiempo ‚Üí APROBAR
- ‚ùå Si falla >20% ‚Üí ITERAR par√°metros

---

## üîß COMPONENTE 2: Strategy A - Mean-Reversion (v9.3)

### Ya Implementada y Testeada

**C√≥digo:** `code/strategies/Multitimeframe/__init__.py` (versi√≥n v9.3-RSI36)

**Par√°metros √≥ptimos:**
```python
# v9.3-RSI36 (ELITE en alta volatilidad)
rsi_long_threshold = 36
rsi_short_threshold = 64
break_even_ratio = 1.35
tp_final_ratio = 3.0
minimum_score = 3
```

**Performance validada:**
```
Periodo: 2023-2025 (Alta volatilidad)
Net Profit: +110.68% üèÜ
Win Rate: 25.14%
Max DD: -19.93%
Calmar: 1.55 (ELITE)
```

**Condici√≥n de activaci√≥n:**
```python
if market_regime == 'volatile':
    use_strategy = 'mean_reversion'
```

**Sin cambios necesarios - ya est√° optimizada.**

---

## üîß COMPONENTE 3: Strategy B - Trend-Following (NUEVO)

### Dise√±o Completo

**Filosof√≠a:**
- Entrar en breakouts (NO en dips)
- Dejar correr las ganancias (trailing stop)
- TP largo (6-8R para capturar mega trends)
- Score system similar a v9.3

### L√≥gica de Entrada LONG

```python
def should_long_trend():
    """
    Trend-Following: Entrar en BREAKOUTS alcistas

    Score m√≠nimo: 4 puntos (m√°s selectivo que mean-reversion)
    """
    score = 0

    # 1. BREAKOUT de resistencia (2 puntos)
    high_20 = max(candles[-20:, 'high'])
    if close > high_20 * 1.01:  # Breakout >1%
        score += 2

    # 2. MACD alcista 1H (2 puntos - se√±al fuerte)
    macd_1h, signal_1h, _ = ta.macd(candles_1h, 15, 30, 9)
    if macd_1h > signal_1h and macd_1h > 0:
        score += 2

    # 3. Momentum alcista (1 punto)
    # Precio > EMA50 15M
    ema_50 = ta.ema(candles, 50)
    if close > ema_50:
        score += 1

    # 4. Volumen confirmaci√≥n (1 punto)
    avg_volume_20 = np.mean(candles[-20:, 'volume'])
    if volume > avg_volume_20 * 1.3:
        score += 1

    # 5. ADX trending (1 punto)
    adx = ta.adx(candles, 14)
    if adx > 25:
        score += 1

    # Score m√≠nimo: 4 puntos
    return score >= 4
```

### L√≥gica de Entrada SHORT

```python
def should_short_trend():
    """
    Trend-Following: Entrar en BREAKDOWNS bajistas
    """
    score = 0

    # 1. BREAKDOWN de soporte (2 puntos)
    low_20 = min(candles[-20:, 'low'])
    if close < low_20 * 0.99:  # Breakdown >1%
        score += 2

    # 2. MACD bajista 1H (2 puntos)
    macd_1h, signal_1h, _ = ta.macd(candles_1h, 15, 30, 9)
    if macd_1h < signal_1h and macd_1h < 0:
        score += 2

    # 3. Momentum bajista (1 punto)
    ema_50 = ta.ema(candles, 50)
    if close < ema_50:
        score += 1

    # 4. Volumen confirmaci√≥n (1 punto)
    avg_volume_20 = np.mean(candles[-20:, 'volume'])
    if volume > avg_volume_20 * 1.3:
        score += 1

    # 5. ADX trending (1 punto)
    adx = ta.adx(candles, 14)
    if adx > 25:
        score += 1

    return score >= 4
```

### Gesti√≥n de Posici√≥n Trend-Following

```python
def update_position_trend():
    """
    TREND-FOLLOWING: Dejar correr ganancias, trailing stop
    """
    if not position.is_open:
        return

    initial_risk = vars['initial_risk_distance']
    current_profit = (close - entry_price) if is_long else (entry_price - close)
    r_ratio = current_profit / initial_risk

    # REGLA 1: Break-even a 3.0R (M√ÅS RELAJADO que mean-reversion)
    if r_ratio >= 3.0 and not vars['tp1_hit']:
        vars['tp1_hit'] = True
        vars['sl_price'] = entry_price

    # REGLA 2: Trailing stop despu√©s de 3.0R
    if r_ratio >= 3.0:
        # Trailing stop: 2R desde el high
        if is_long:
            highest_price = max(highest_price, close)
            new_sl = highest_price - (initial_risk * 2.0)
            vars['sl_price'] = max(vars['sl_price'], new_sl)
        else:
            lowest_price = min(lowest_price, close)
            new_sl = lowest_price + (initial_risk * 2.0)
            vars['sl_price'] = min(vars['sl_price'], new_sl)

    # REGLA 3: TP final en 6.0R (para capturar mega trends)
    # Pero trailing puede cerrar antes si hay reversi√≥n
    if r_ratio >= 6.0:
        liquidate()
        return
```

### Par√°metros Trend-Following

```python
# Strategy B: Trend-Following
breakout_lookback = 20      # Velas para detectar breakout
breakout_threshold = 0.01   # 1% breakout m√≠nimo
minimum_score = 4           # M√°s selectivo que mean-reversion
break_even_ratio = 3.0      # M√°s relajado
tp_final_ratio = 6.0        # M√°s ambicioso
trailing_stop_ratio = 2.0   # Trailing 2R desde high
```

---

## üß™ Testing Strategy - Fase por Fase

### Test 1: Trend Strategy Solo (2020-2021)

**Objetivo:** Validar que Trend-Following funciona en parab√≥lico

**Backtest:**
```
Exchange: Binance Futures
Period: 2020-01-01 ‚Üí 2021-12-31
Strategy: Trend-Following ONLY (sin regime detection)
```

**Criterios de √©xito:**
- ‚úÖ Net Profit > +30%
- ‚úÖ Win Rate > 18%
- ‚úÖ Max DD < -40%
- ‚úÖ Calmar > 0.8

**Si falla:** Iterar par√°metros (score, BE, TP)

---

### Test 2: Mean Strategy Solo (2022-2025)

**Objetivo:** Re-validar que Mean-Reversion sigue funcionando

**Backtest:**
```
Exchange: Binance Futures
Period: 2022-01-01 ‚Üí 2025-12-27
Strategy: Mean-Reversion ONLY (v9.3)
```

**Criterios de √©xito:**
- ‚úÖ Net Profit > +80%
- ‚úÖ Win Rate > 24%
- ‚úÖ Max DD < -25%
- ‚úÖ Calmar > 1.3

**Si falla:** Verificar si algo cambi√≥ vs v9.3 original

---

### Test 3: Regime Detector Accuracy (2020-2025)

**Objetivo:** Validar que detector clasifica correctamente

**Backtest:**
```
Exchange: Binance Futures
Period: 2020-01-01 ‚Üí 2025-12-27
Test: Regime detection vs manual classification
```

**Manual classification esperada:**
```
2020 Q1-Q2: Parabolic (BTC $7k ‚Üí $12k)
2020 Q3-Q4: Parabolic (BTC $10k ‚Üí $29k)
2021 Q1-Q2: Parabolic (BTC $29k ‚Üí $64k)
2021 Q3-Q4: Volatile (BTC crash -50%)
2022 Q1-Q4: Volatile (bear market)
2023 Q1-Q2: Volatile (recovery)
2023 Q3-Q4: Parabolic (BTC $27k ‚Üí $44k)
2024 Q1-Q4: Volatile (consolidation)
2025 Q1: Parabolic/Volatile (mixed)
```

**Accuracy target:**
- ‚úÖ >80% correct classification ‚Üí APROBAR
- ‚ö†Ô∏è 70-80% ‚Üí ITERAR par√°metros
- ‚ùå <70% ‚Üí RE-DISE√ëAR detector

---

### Test 4: HYBRID SYSTEM Complete (2020-2025)

**Objetivo:** Validar sistema completo con switching autom√°tico

**Backtest:**
```
Exchange: Binance Futures
Period: 2020-01-01 ‚Üí 2025-12-27 (5.88 a√±os)
Strategy: v11.0-UNIVERSAL (regime detection + dual strategy)
```

**Criterios de √©xito (7/7 para deployment):**

**Periodo completo 2020-2025:**
- ‚úÖ Net Profit > +60%
- ‚úÖ Win Rate > 20%
- ‚úÖ Max DD < -35%
- ‚úÖ Calmar > 1.0

**Periodo 2023-2025 (no degradar mucho vs v9.3):**
- ‚úÖ Net Profit > +80% (toleramos -30% vs v9.3)
- ‚úÖ Max DD < -25%
- ‚úÖ Calmar > 1.2

**Resultado:**
- **7/7:** ‚úÖ DEPLOYMENT APROBADO
- **5-6/7:** ‚ö†Ô∏è Iterar a v11.1
- **<5/7:** ‚ùå Re-dise√±ar

---

## üìä Performance Esperada v11.0-UNIVERSAL

### Proyecci√≥n Realista

| Periodo | R√©gimen | Strategy Activa | Net Profit | Win Rate | Max DD | Calmar |
|---------|---------|-----------------|------------|----------|--------|--------|
| **2020** | Parabolic | Trend | +40% | 18% | -25% | 1.6 |
| **2021** | Parabolic | Trend | +35% | 17% | -30% | 1.2 |
| **2022** | Volatile | Mean | -5% | 22% | -28% | -0.2 |
| **2023** | Volatile | Mean | +60% | 26% | -18% | 3.3 |
| **2024** | Volatile | Mean | +35% | 24% | -22% | 1.6 |
| **2025** | Mixed | Both | +15% | 21% | -15% | 1.0 |
| **TOTAL** | - | Hybrid | **+80-100%** | **21%** | **-35%** | **~1.3** |

**Comparaci√≥n:**

| Versi√≥n | Profit 2020-2025 | Profit 2023-2025 | Calmar | Robustez |
|---------|------------------|------------------|--------|----------|
| **v9.3-RSI36** | -66.43% ‚ùå | +110.68% üèÜ | -0.20 / 1.55 | ‚ùå Solo vol√°til |
| **v10.0-ROBUST** | -60.2% ‚ùå | +70-90%? | -0.18 / 1.0-1.3? | ‚ùå Falla igual |
| **v11.0-UNIVERSAL** | **+80-100% ‚úÖ** | **+80-100% ‚úÖ** | **~1.3 ‚úÖ** | ‚úÖ Universal |

**Mejora:**
- +146-166% profit vs v9.3 en periodo completo
- Ligeramente menos profit en 2023-2025 (-10-30%) pero GANA robustez
- Calmar consistente >1.0 en TODOS los reg√≠menes

---

## üìÅ Estructura de C√≥digo

### Jesse Framework (para backtesting)

```
TradingBot_Project/
‚îú‚îÄ‚îÄ code/
‚îÇ   ‚îî‚îÄ‚îÄ strategies/
‚îÇ       ‚îú‚îÄ‚îÄ Multitimeframe/
‚îÇ       ‚îÇ   ‚îî‚îÄ‚îÄ __init__.py  (v9.3 - Mean-Reversion)
‚îÇ       ‚îî‚îÄ‚îÄ MultitimeframeTrend/
‚îÇ           ‚îî‚îÄ‚îÄ __init__.py  (NEW - Trend-Following)
‚îÇ       ‚îî‚îÄ‚îÄ UniversalHybrid/
‚îÇ           ‚îî‚îÄ‚îÄ __init__.py  (NEW - v11.0 Sistema completo)
```

### Freqtrade (para deployment)

```
Freqtrade_Project/
‚îú‚îÄ‚îÄ user_data/
‚îÇ   ‚îî‚îÄ‚îÄ strategies/
‚îÇ       ‚îú‚îÄ‚îÄ Multitimeframe_v93_Complete.py  (ACTUAL)
‚îÇ       ‚îú‚îÄ‚îÄ TrendFollowing_v11.py           (NEW)
‚îÇ       ‚îî‚îÄ‚îÄ Universal_v11_Hybrid.py         (NEW - Final)
```

---

## ‚è±Ô∏è Timeline Detallado

### SEMANA 1: Regime Detection + Trend Design

**D√≠a 1 (Hoy - 2025-12-28):**
- [x] Analizar fallo v10.0
- [x] Dise√±ar master plan v11.0
- [ ] Crear estructura de archivos

**D√≠a 2 (2025-12-29):**
- [ ] Implementar algoritmo regime detection
- [ ] Testear detector en datos hist√≥ricos
- [ ] Validar accuracy >80%

**D√≠a 3 (2025-12-30):**
- [ ] Dise√±ar l√≥gica Trend-Following completa
- [ ] Implementar score system para breakouts
- [ ] Crear funci√≥n update_position_trend()

**D√≠a 4 (2025-12-31):**
- [ ] Implementar c√≥digo completo Trend strategy
- [ ] Code review y debugging
- [ ] Preparar backtest

**D√≠a 5-7 (2026-01-01 a 01-03):**
- [ ] Backtest Trend strategy 2020-2021
- [ ] Analizar resultados
- [ ] Iterar par√°metros si necesario
- [ ] Validar criterios de √©xito (Test 1)

---

### SEMANA 2: Integraci√≥n + Backtesting Completo

**D√≠a 8-10 (2026-01-04 a 01-06):**
- [ ] Integrar regime detector + ambas strategies
- [ ] Crear sistema de switching autom√°tico
- [ ] Testing unitario de componentes
- [ ] Code review completo

**D√≠a 11-12 (2026-01-07 a 01-08):**
- [ ] Backtest sistema completo 2020-2025
- [ ] Analizar m√©tricas vs criterios
- [ ] Documentar resultados

**D√≠a 13-14 (2026-01-09 a 01-10):**
- [ ] Walk-forward validation
- [ ] Train: 2020-2022, Test: 2023-2025
- [ ] Verificar no overfitting
- [ ] Validar robustez

---

### SEMANA 3: Optimizaci√≥n + Refinamiento

**D√≠a 15-17 (2026-01-11 a 01-13):**
- [ ] Ajustar par√°metros bas√°ndose en backtests
- [ ] Re-testear con nuevos par√°metros
- [ ] Optimizaci√≥n fina

**D√≠a 18-19 (2026-01-14 a 01-15):**
- [ ] Stress testing eventos extremos
- [ ] Luna crash, FTX, Banking crisis
- [ ] Validar que sobrevive

**D√≠a 20-21 (2026-01-16 a 01-17):**
- [ ] Finalizar c√≥digo Jesse
- [ ] Documentaci√≥n completa
- [ ] Preparar migraci√≥n a Freqtrade

---

### SEMANA 4: Migraci√≥n a Freqtrade + Deployment

**D√≠a 22-24 (2026-01-18 a 01-20):**
- [ ] Portar c√≥digo a Freqtrade
- [ ] Adaptar sintaxis Jesse ‚Üí Freqtrade
- [ ] Testing local

**D√≠a 25-26 (2026-01-21 a 01-22):**
- [ ] Deploy en Binance Testnet
- [ ] Monitorear primeros trades
- [ ] Validar funcionamiento

**D√≠a 27-28 (2026-01-23 a 01-24):**
- [ ] Detener v9.3 paper trading
- [ ] Iniciar v11.0 paper trading
- [ ] Monitoreo intensivo primeros 50 trades
- [ ] ‚úÖ DEPLOYMENT COMPLETO

---

## ‚úÖ Criterios de Decisi√≥n en Cada Fase

### Checkpoints de Validaci√≥n

**Checkpoint 1 (Fin Semana 1):**
- ¬øTrend strategy funciona en 2020-2021?
- **SI:** Continuar a Semana 2
- **NO:** Iterar dise√±o Trend strategy

**Checkpoint 2 (Fin Semana 2):**
- ¬øSistema h√≠brido pasa criterios 2020-2025?
- **SI:** Continuar a Semana 3
- **NO:** Ajustar par√°metros, repetir backtests

**Checkpoint 3 (Fin Semana 3):**
- ¬øWalk-forward validation exitosa?
- **SI:** Continuar a Semana 4 (migraci√≥n)
- **NO:** Re-dise√±ar approach

**Checkpoint 4 (Fin Semana 4):**
- ¬øPrimeros trades en paper trading exitosos?
- **SI:** ‚úÖ DEPLOYMENT COMPLETO
- **NO:** Debugging y monitoreo extendido

---

## üìã Pr√≥xima Acci√≥n Inmediata

### Hoy (2025-12-28) - Resto del d√≠a

1. **Crear archivos base:**
   - [ ] `regime_detector.py` (m√≥dulo independiente)
   - [ ] `TrendFollowing_v11.py` (estrategia nueva)
   - [ ] `SEMANA1_PROGRESS.md` (tracking)

2. **Empezar dise√±o Regime Detector:**
   - [ ] Implementar funci√≥n `detect_market_regime()`
   - [ ] Preparar datos para testing

3. **Mantener v9.3 corriendo:**
   - [ ] Verificar que sigue en paper trading
   - [ ] Revisar √∫ltimos trades

**Tiempo estimado:** 2-3 horas

---

## üéØ Objetivo Final

```
v11.0-UNIVERSAL DEPLOYED
‚îú‚îÄ Paper trading activo en Binance Testnet
‚îú‚îÄ Regime detection autom√°tico funcionando
‚îú‚îÄ Mean-Reversion activa en mercado actual
‚îú‚îÄ Trend-Following lista para cuando mercado cambie
‚îú‚îÄ Performance proyectada: +80-100% anual universal
‚îî‚îÄ Calmar ratio >1.2 en CUALQUIER r√©gimen
```

**Estado actual:** üìç Semana 1, D√≠a 1 - Master Plan completado

**Pr√≥ximo hito:** Implementar Regime Detector (D√≠a 2)

---

**Creado:** 2025-12-28
**Timeline:** 3-4 semanas
**Objetivo:** Bot universal que funciona √ìPTIMAMENTE en cualquier condici√≥n
**Probabilidad de √©xito:** 80-90% (con iteraci√≥n)
